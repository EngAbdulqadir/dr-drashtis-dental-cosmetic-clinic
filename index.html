<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Dr. Drashti's Advanced Dental and Cosmetic Clinic</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <!-- Header -->
    <header>
        <div class="nav-container">
            <div class="logo-section">
                <img src="logo.png" alt="Clinic Logo">
                <div class="clinic-name">
                    <h1>Dr. Drashti's</h1>
                    <span>Advanced Dental & Cosmetic Clinic</span>
                </div>
            </div>
            <nav>
                <ul>
                    <li><a href="#home" onclick="showSection('home')">Home</a></li>
                    <li><a href="#appointment" onclick="showSection('appointment')" class="btn-primary">Book
                            Appointment</a></li>
                    <li><a href="#" onclick="toggleDashboard()">Staff Dashboard</a></li>
                    <li><button onclick="toggleTheme()" class="theme-toggle" title="Switch Theme">
                            <i class="fas fa-palette"></i>
                        </button></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content">
        <!-- Hero Section -->
        <section id="home" class="hero">
            <div class="hero-content">
                <h2>Your Smile, Our Passion</h2>
                <p>Experience world-class dental and cosmetic care in Dahod. We combine advanced technology with
                    aesthetic expertise.</p>
                <a href="#appointment" onclick="showSection('appointment')" class="btn-primary">Book Your Visit</a>
            </div>
        </section>

        <!-- Appointment Section -->
        <section id="appointment" class="appointment-section">
            <div class="container">
                <h2 class="section-title">Book an Appointment</h2>
                <form class="appointment-form" id="bookingForm">
                    <div class="form-group">
                        <label for="name">Patient Name *</label>
                        <input type="text" id="name" required placeholder="Enter full name" minlength="2" maxlength="50"
                            pattern="[A-Za-z\s]+" title="Please enter a valid name (letters and spaces only)">
                    </div>
                    <div class="form-group">
                        <label for="place">Place/City *</label>
                        <input type="text" id="place" required placeholder="e.g. Dahod" minlength="2" maxlength="50"
                            pattern="[A-Za-z\s]+" title="Please enter a valid city name (letters and spaces only)">
                    </div>
                    <div class="form-group">
                        <label for="mobile">Mobile Number *</label>
                        <input type="tel" id="mobile" required placeholder="10-digit number" pattern="[0-9]{10}"
                            maxlength="10" title="Please enter exactly 10 digits"
                            oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                    </div>
                    <div class="form-group">
                        <label for="appointmentDate">Appointment Date *</label>
                        <input type="date" id="appointmentDate" required title="Please select an appointment date">
                    </div>
                    <div class="form-group">
                        <label for="appointmentTime">Appointment Time (30-min slots) *</label>
                        <select id="appointmentTime" required title="Please select an available time slot">
                            <option value="">Select time slot...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reason">Reason for Treatment *</label>
                        <select id="reason" required title="Please select a treatment reason">
                            <option value="">Select a service...</option>
                            <option value="General Consultation">General Consultation</option>
                            <option value="Teeth Whitening">Teeth Whitening</option>
                            <option value="Root Canal">Root Canal</option>
                            <option value="Cosmetic Correction">Cosmetic Correction</option>
                            <option value="Orthodontics">Orthodontics (Braces)</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <button type="submit" class="btn-primary" style="width: 100%">Confirm Booking</button>
                </form>
            </div>
        </section>
    </main>

    <!-- Dashboard Section -->
    <section id="dashboard" class="dashboard-section">
        <div class="container">
            <h2 class="section-title">Patient Dashboard</h2>
            <div class="dashboard-header">
                <h2>Staff Dashboard</h2>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="showSection('home')" class="btn-primary" style="background-color: #666;">Back to
                        Home</button>
                    <button id="settingsBtn" onclick="openSettingsModal()" class="btn-primary"
                        style="background-color: #555; display: none;">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                    <button onclick="logout()" class="btn-primary" style="background-color: #dc3545;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>

            <!-- Stats Row -->
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-info">
                        <h3>Total Patients</h3>
                        <p id="totalPatients">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-rupee-sign"></i></div>
                    <div class="stat-info">
                        <h3>Total Earnings</h3>
                        <p id="totalEarnings">₹0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-clock"></i></div>
                    <div class="stat-info">
                        <h3>Pending Visits</h3>
                        <p id="pendingVisits">0</p>
                    </div>
                </div>
            </div>

            <!-- Dashboard Controls -->
            <div class="controls-container">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search by name or mobile..."
                        onkeyup="filterAppointments()">
                </div>
                <div class="filter-box">
                    <select id="dateFilter" onchange="filterAppointments()">
                        <option value="all">All Dates</option>
                        <option value="today">Today</option>
                    </select>
                </div>
                <button onclick="window.print()" class="btn-primary"><i class="fas fa-print"></i> Print
                    Schedule</button>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Registered Patients</h3>

                    <!-- Mobile Card View -->
                    <div class="patients-cards" id="patientsCards">
                        <!-- Cards will be populated here for mobile -->
                    </div>

                    <!-- Desktop Table View -->
                    <div class="table-container">
                        <table id="patientsTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Patient Info</th>
                                    <th>Treatment</th>
                                    <th>Status</th>
                                    <th>Fees (₹)</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="noDataMessage" style="text-align: center; padding: 2rem; color: #888; display: none;">
                        No appointments found.
                    </div>
                </div>

                <div class="dashboard-card">
                    <h3>Treatments Breakdown</h3>
                    <div class="chart-container">
                        <canvas id="treatmentChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;">Staff Login</h2>
            <form id="loginForm" style="display: flex; flex-direction: column; gap: 1rem;">
                <div class="form-group">
                    <label for="username">Username or Email</label>
                    <input type="text" id="username" required placeholder="Enter username or email">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" required placeholder="Enter password">
                </div>
                <div style="text-align: right; margin-top: -0.5rem;">
                    <a href="#" onclick="showForgotPasswordModal(); return false;"
                        style="color: var(--primary-color); font-size: 0.9rem; text-decoration: none;">Forgot
                        Password?</a>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button type="submit" class="btn-primary" style="flex: 1;">Login</button>
                    <button type="button" onclick="closeLoginModal()" class="btn-primary"
                        style="flex: 1; background-color: #999;">Cancel</button>
                </div>
            </form>
            <p id="loginError" style="color: red; margin-top: 1rem; display: none; text-align: center;"></p>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgotPasswordModal" class="modal">
        <div class="modal-content">
            <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;">Reset Password</h2>
            <p style="margin-bottom: 1.5rem; color: #666;">Enter your email address and we'll send you a password reset
                link.</p>
            <form id="forgotPasswordForm" style="display: flex; flex-direction: column; gap: 1rem;">
                <div class="form-group">
                    <label for="resetEmail">Email Address</label>
                    <input type="email" id="resetEmail" required placeholder="Enter your email">
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button type="submit" class="btn-primary" style="flex: 1;">Send Reset Link</button>
                    <button type="button" onclick="closeForgotPasswordModal()" class="btn-primary"
                        style="flex: 1; background-color: #999;">Cancel</button>
                </div>
            </form>
            <p id="resetMessage" style="margin-top: 1rem; display: none; text-align: center;"></p>
        </div>
    </div>

    <!-- Duplicate Check Success Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content" style="text-align: center;">
            <div style="color: var(--primary-color); font-size: 3rem; margin-bottom: 1rem;">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2 style="color: var(--primary-color); margin-bottom: 1rem;">Booking Confirmed!</h2>
            <p>Your appointment has been successfully scheduled.</p>
            <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">We look forward to seeing you.</p>
            <button onclick="closeBookingModal()" class="btn-primary" style="margin-top: 1.5rem;">Done</button>
        </div>
    </div>

    <!-- Settings Modal (Super Admin Only) -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeSettingsModal()">&times;</span>
            <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;">App Settings (White Label)</h2>
            <form id="settingsForm" style="display: flex; flex-direction: column; gap: 1rem;">
                <div class="form-group">
                    <label for="settingClinicName">Clinic Name</label>
                    <input type="text" id="settingClinicName" placeholder="Dr. Drashti's...">
                </div>
                <div class="form-group">
                    <label for="settingSubtitle">Subtitle / Tagline</label>
                    <input type="text" id="settingSubtitle" placeholder="Advanced Dental...">
                </div>
                <div class="form-group">
                    <label for="settingPrimaryColor">Primary Color (Theme)</label>
                    <input type="color" id="settingPrimaryColor" value="#26A69A" style="height: 50px; cursor: pointer;">
                </div>
                <div class="form-group">
                    <label for="settingSecondaryColor">Secondary Color</label>
                    <input type="color" id="settingSecondaryColor" value="#42A5F5"
                        style="height: 50px; cursor: pointer;">
                </div>
                <div style="border-top: 1px solid #ddd; margin: 0.5rem 0;"></div>
                <h3 style="font-size: 1rem; color: #666;">Default Admin Credentials</h3>
                <div class="form-group">
                    <label for="settingAdminUser">Admin Username/Email</label>
                    <input type="text" id="settingAdminUser" placeholder="admin">
                </div>
                <div class="form-group">
                    <label for="settingAdminPass">Admin Password</label>
                    <input type="text" id="settingAdminPass" placeholder="password">
                </div>
                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <footer>
        <p>&copy; 2026 Dr. Drashti's Advanced Dental and Cosmetic Clinic, Dahod. All rights reserved.</p>
    </footer>

    <!-- Supabase JS Client (Free Open-Source Database) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script src="db-api.js?v=2.2"></script>
    <script src="auth.js?v=2.2"></script>
    <script src="theme-switcher.js?v=2.2"></script>
    <script src="script.js?v=2.2"></script>
</body>

</html>